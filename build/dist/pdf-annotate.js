!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.PDFAnnotate=t():e.PDFAnnotate=t()}(window,function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=12)}([function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=u(n(7)),o=u(n(16)),i=u(n(18)),a=u(n(28));function u(e){return e&&e.__esModule?e:{default:e}}t.default={StoreAdapter:r.default,LocalStoreAdapter:o.default,__storeAdapter:new r.default,getStoreAdapter:function(){return this.__storeAdapter},setStoreAdapter:function(e){this.__storeAdapter=e},UI:a.default,render:i.default,getAnnotations:function(e,t){var n;return(n=this.getStoreAdapter()).getAnnotations.apply(n,arguments)}},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BORDER_COLOR=void 0,t.findSVGContainer=function(e){var t=e;for(;(t=t.parentNode)&&t!==document;)if("SVG"===t.nodeName.toUpperCase()&&"true"===t.getAttribute("data-pdf-annotate-container"))return t;return null},t.findSVGAtPoint=i,t.findAnnotationAtPoint=function(e,t){var n=i(e,t);if(!n)return;for(var r=n.querySelectorAll("[data-pdf-annotate-type]"),o=0,s=r.length;o<s;o++){var d=r[o];if(a(e,t,u(d)))return d}return null},t.pointIntersectsRect=a,t.getOffsetAnnotationRect=u,t.getAnnotationRect=s,t.scaleUp=d,t.scaleDown=function(e,t){var n={},r=c(e).viewport;return Object.keys(t).forEach(function(e){n[e]=t[e]/r.scale}),n},t.getScroll=function(e){var t=0,n=0,r=e;for(;(r=r.parentNode)&&r!==document;)t+=r.scrollTop,n+=r.scrollLeft;return{scrollTop:t,scrollLeft:n}},t.getOffset=l,t.disableUserSelect=function(){o.parentNode||document.head.appendChild(o)},t.enableUserSelect=function(){o.parentNode&&o.parentNode.removeChild(o)},t.getMetadata=c;var r=function(e){return e&&e.__esModule?e:{default:e}}(n(15));t.BORDER_COLOR="#00BFFF";var o=(0,r.default)({body:{"-webkit-user-select":"none","-moz-user-select":"none","-ms-user-select":"none","user-select":"none"}});function i(e,t){for(var n=document.querySelectorAll('svg[data-pdf-annotate-container="true"]'),r=0,o=n.length;r<o;r++){var i=n[r];if(a(e,t,i.getBoundingClientRect()))return i}return null}function a(e,t,n){return t>=n.top&&t<=n.bottom&&e>=n.left&&e<=n.right}function u(e){var t=s(e),n=l(e),r=n.offsetLeft,o=n.offsetTop;return{top:t.top+o,left:t.left+r,right:t.right+r,bottom:t.bottom+o}}function s(e){var t=0,n=0,r=0,o=0,a=e.getBoundingClientRect();switch(e.nodeName.toLowerCase()){case"path":var u=void 0,s=void 0,c=void 0,f=void 0;e.getAttribute("d").replace(/Z/,"").split("M").splice(1).forEach(function(e){var t=e.split(" ").map(function(e){return parseInt(e,10)});(void 0===u||t[0]<u)&&(u=t[0]),(void 0===s||t[2]>s)&&(s=t[2]),(void 0===c||t[1]<c)&&(c=t[1]),(void 0===f||t[3]>f)&&(f=t[3])}),t=f-c,n=s-u,r=u,o=c;break;case"line":t=parseInt(e.getAttribute("y2"),10)-parseInt(e.getAttribute("y1"),10),n=parseInt(e.getAttribute("x2"),10)-parseInt(e.getAttribute("x1"),10),r=parseInt(e.getAttribute("x1"),10),o=parseInt(e.getAttribute("y1"),10),0===t&&(t+=16,o-=8);break;case"text":t=a.height,n=a.width,r=parseInt(e.getAttribute("x"),10),o=parseInt(e.getAttribute("y"),10)-t;break;case"g":var p=l(e),v=p.offsetLeft,h=p.offsetTop;t=a.height,n=a.width,r=a.left-v,o=a.top-h,"strikeout"===e.getAttribute("data-pdf-annotate-type")&&(t+=16,o-=8);break;case"rect":case"svg":t=parseInt(e.getAttribute("height"),10),n=parseInt(e.getAttribute("width"),10),r=parseInt(e.getAttribute("x"),10),o=parseInt(e.getAttribute("y"),10)}var y={top:o,left:r,width:n,height:t,right:r+n,bottom:o+t};return["svg","g"].includes(e.nodeName.toLowerCase())||(y=d(i(a.left,a.top),y)),y}function d(e,t){var n={},r=c(e).viewport;return Object.keys(t).forEach(function(e){n[e]=t[e]*r.scale}),n}function l(e){for(var t=e;(t=t.parentNode)&&t!==document&&"SVG"!==t.nodeName.toUpperCase(););var n=t.getBoundingClientRect();return{offsetLeft:n.left,offsetTop:n.top}}function c(e){return{documentId:e.getAttribute("data-pdf-annotate-document"),pageNumber:parseInt(e.getAttribute("data-pdf-annotate-page"),10),viewport:JSON.parse(e.getAttribute("data-pdf-annotate-viewport"))}}o.setAttribute("data-pdf-annotate-user-select","true")},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){n||(n=JSON.parse(e.getAttribute("data-pdf-annotate-viewport")));var d=void 0;switch(t.type){case"area":case"highlight":d=(0,u.default)(t);break;case"strikeout":d=(0,o.default)(t);break;case"point":d=(0,a.default)(t);break;case"textbox":d=(0,s.default)(t);break;case"drawing":d=(0,i.default)(t)}d&&(d.setAttribute("data-pdf-annotate-id",t.uuid),d.setAttribute("data-pdf-annotate-type",t.type),d.setAttribute("aria-hidden",!0),e.appendChild(function e(t,n){var o=function(e){var t=void 0,n=void 0;switch(e.rotation%360){case 0:t=n=0;break;case 90:t=0,n=e.width/e.scale*-1;break;case 180:t=e.width/e.scale*-1,n=e.height/e.scale*-1;break;case 270:t=e.height/e.scale*-1,n=0}return{x:t,y:n}}(n);t.setAttribute("transform","scale("+n.scale+") rotate("+n.rotation+") translate("+o.x+", "+o.y+")");if(!l&&"svg"===t.nodeName.toLowerCase()){t.setAttribute("x",parseInt(t.getAttribute("x"),10)*n.scale),t.setAttribute("y",parseInt(t.getAttribute("y"),10)*n.scale);var i=parseInt(t.getAttribute("x",10)),a=parseInt(t.getAttribute("y",10)),u=parseInt(t.getAttribute("width"),10),s=parseInt(t.getAttribute("height"),10),d=t.querySelector("path"),c=d.parentNode;switch([t,c,d,t.querySelector("rect")].forEach(function(e){e.setAttribute("width",parseInt(e.getAttribute("width"),10)*n.scale),e.setAttribute("height",parseInt(e.getAttribute("height"),10)*n.scale)}),e(d,(0,r.default)({},n,{scale:1})),n.rotation%360){case 90:t.setAttribute("x",n.width-a-u),t.setAttribute("y",i),c.setAttribute("x",1),c.setAttribute("y",0);break;case 180:t.setAttribute("x",n.width-i-u),t.setAttribute("y",n.height-a-s),c.setAttribute("y",2);break;case 270:t.setAttribute("x",a),t.setAttribute("y",n.height-i-s),c.setAttribute("x",-1),c.setAttribute("y",0)}}return t}(d,n)));return d};var r=d(n(19)),o=d(n(20)),i=d(n(21)),a=d(n(22)),u=d(n(23)),s=d(n(24));function d(e){return e&&e.__esModule?e:{default:e}}var l=/firefox/i.test(navigator.userAgent);e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){Object.keys(t).forEach(function(n){e.setAttribute(i(n),t[n])})};var r=/[A-Z]/g,o=["viewBox"],i=function(e){return-1===o.indexOf(e)&&(e=e.replace(r,function(e){return"-"+e.toLowerCase()})),e};e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.fireEvent=function(){i.emit.apply(i,arguments)},t.addEventListener=function(){i.on.apply(i,arguments)},t.removeEventListener=function(){i.removeListener.apply(i,arguments)};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(14)),o=n(1);var i=new r.default,a=void 0;document.addEventListener("click",function(e){if((0,o.findSVGAtPoint)(e.clientX,e.clientY)){var t=(0,o.findAnnotationAtPoint)(e.clientX,e.clientY);a&&a!==t&&i.emit("annotation:blur",a),t&&i.emit("annotation:click",t),a=t}})},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){r.test(e)&&(e="#"+e);return e};var r=/^([a-f0-9]{6}|[a-f0-9]{3})$/i;e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){e=Array.isArray(e)?e:[],Object.keys(u).forEach(function(t){var n=u[t];e.filter(function(e){return e.type===t}).sort(n).forEach(function(e,t){return(0,r.default)(e,t+1)})})};var r=o(n(8));function o(e){return e&&e.__esModule?e:{default:e}}function i(e,t){return e.y<t.y?e.x-t.x:1}function a(e,t){return i(e.rectangles[0],t.rectangles[0])}(0,o(n(27)).default)();var u={highlight:a,strikeout:a,drawing:function(e,t){var n=e.lines[0],r=t.lines[0];return i({x:n[0],y:n[1]},{x:r[0],y:r[1]})},textbox:i,point:i,area:i};e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=function(e){return e&&e.__esModule?e:{default:e}}(n(13)),i=n(4);var a=function(){function e(){var t=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),Object.keys(n).forEach(function(e){"function"==typeof n[e]&&"function"==typeof t[e]&&(t[e]=n[e])})}return r(e,[{key:"__getAnnotations",value:function(e,t){(0,o.default)("getAnnotations")}},{key:"getAnnotation",value:function(e,t){(0,o.default)("getAnnotation")}},{key:"__addAnnotation",value:function(e,t,n){(0,o.default)("addAnnotation")}},{key:"__editAnnotation",value:function(e,t,n){(0,o.default)("editAnnotation")}},{key:"__deleteAnnotation",value:function(e,t){(0,o.default)("deleteAnnotation")}},{key:"getComments",value:function(e,t){(0,o.default)("getComments")}},{key:"__addComment",value:function(e,t,n){(0,o.default)("addComment")}},{key:"__deleteComment",value:function(e,t){(0,o.default)("deleteComment")}},{key:"getAnnotations",get:function(){return this.__getAnnotations},set:function(e){this.__getAnnotations=function(t,n){return e.apply(void 0,arguments).then(function(e){return e.annotations&&e.annotations.forEach(function(e){e.documentId=t}),e})}}},{key:"addAnnotation",get:function(){return this.__addAnnotation},set:function(e){this.__addAnnotation=function(t,n,r){return e.apply(void 0,arguments).then(function(e){return(0,i.fireEvent)("annotation:add",t,n,e),e})}}},{key:"editAnnotation",get:function(){return this.__editAnnotation},set:function(e){this.__editAnnotation=function(t,n,r){return e.apply(void 0,arguments).then(function(e){return(0,i.fireEvent)("annotation:edit",t,n,e),e})}}},{key:"deleteAnnotation",get:function(){return this.__deleteAnnotation},set:function(e){this.__deleteAnnotation=function(t,n){return e.apply(void 0,arguments).then(function(e){return e&&(0,i.fireEvent)("annotation:delete",t,n),e})}}},{key:"addComment",get:function(){return this.__addComment},set:function(e){this.__addComment=function(t,n,r){return e.apply(void 0,arguments).then(function(e){return(0,i.fireEvent)("comment:add",t,n,e),e})}}},{key:"deleteComment",get:function(){return this.__deleteComment},set:function(e){this.__deleteComment=function(t,n){return e.apply(void 0,arguments).then(function(e){return e&&(0,i.fireEvent)("comment:delete",t,n),e})}}}]),e}();t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;switch(e.type){case"highlight":case"strikeout":var n=e.rectangles,u=n[0],d=n[n.length-1];(0,i.default)((0,r.default)("Begin "+e.type+" annotation "+t,e.uuid),u.x,u.y,e.page,!0),(0,i.default)((0,r.default)("End "+e.type+" annotation "+t,e.uuid+"-end"),d.x+d.width,d.y,e.page,!1);break;case"textbox":case"point":var l="textbox"===e.type?" (content: "+e.content+")":"";(0,o.default)((0,r.default)(e.type+" annotation "+t+l,e.uuid),e.x,e.y,e.page);break;case"drawing":case"area":var c=void 0!==e.x?e.x:e.lines[0][0],f=void 0!==e.y?e.y:e.lines[0][1];(0,o.default)((0,r.default)("Unlabeled drawing",e.uuid),c,f,e.page)}s.includes(e.type)&&(0,a.default)(e.documentId,e.uuid)};var r=u(n(25)),o=u(n(26)),i=u(n(9)),a=u(n(10));function u(e){return e&&e.__esModule?e:{default:e}}var s=["highlight","point","area"];e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,o,i){var a=function(e,t,n){var o=document.querySelector('svg[data-pdf-annotate-page="'+n+'"]'),i=o.getBoundingClientRect();return t=(0,r.scaleUp)(o,{y:t}).y+i.top,e=(0,r.scaleUp)(o,{x:e}).x+i.left,[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(o.parentNode.querySelectorAll(".textLayer [data-canvas-width]"))).filter(function(n){return(0,r.pointIntersectsRect)(e,t,n.getBoundingClientRect())})[0]}(t=Math.max(t+2*(i?1:-1),0),n+2,o);if(!a)return!1;t+=2*(i?-1:1);var u=document.querySelector('svg[data-pdf-annotate-page="'+o+'"]'),s=(0,r.scaleDown)(u,{left:a.getBoundingClientRect().left}).left-u.getBoundingClientRect().left,d=a.cloneNode(!0),l=d.innerHTML.split(""),c=[];d.style.position="absolute",d.style.top="-10000px",d.style.left="-10000px",document.body.appendChild(d);for(;l.length;){if(">"===l[l.length-1])for(;l.length&&(c.unshift(l.pop()),"<"!==c[0]););d.innerHTML=l.join("");var f=(0,r.scaleDown)(u,{width:d.getBoundingClientRect().width}).width;if(s+f<=t)break;c.unshift(l.pop())}return a.innerHTML=l.join("")+e.outerHTML+c.join(""),d.parentNode.removeChild(d),!0};var r=n(1);e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){var i=void 0;i=Array.isArray(n)?Promise.resolve(n):r.default.getStoreAdapter().getComments(e,t);return i.then(function(e){var n=document.getElementById("pdf-annotate-screenreader-"+t);if(n){var r=document.createElement("ol");r.setAttribute("id","pdf-annotate-screenreader-comment-list-"+t),r.setAttribute("aria-label","Comments"),n.appendChild(r),e.forEach(o.default)}})};var r=i(n(0)),o=i(n(11));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(!e)return;var t=document.querySelector("#pdf-annotate-screenreader-"+e.annotation+" ol");if(t){var n=document.createElement("li");n.setAttribute("id","pdf-annotate-screenreader-comment-"+e.uuid),n.appendChild(document.createTextNode(""+e.content)),t.appendChild(n)}},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(e){return e&&e.__esModule?e:{default:e}}(n(0));t.default=r.default,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){throw new Error(e+" is not implemented")},e.exports=t.default},function(e,t){function n(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function r(e){return"function"==typeof e}function o(e){return"object"==typeof e&&null!==e}function i(e){return void 0===e}e.exports=n,n.EventEmitter=n,n.prototype._events=void 0,n.prototype._maxListeners=void 0,n.defaultMaxListeners=10,n.prototype.setMaxListeners=function(e){if(!function(e){return"number"==typeof e}(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},n.prototype.emit=function(e){var t,n,a,u,s,d;if(this._events||(this._events={}),"error"===e&&(!this._events.error||o(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var l=new Error('Uncaught, unspecified "error" event. ('+t+")");throw l.context=t,l}if(i(n=this._events[e]))return!1;if(r(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:u=Array.prototype.slice.call(arguments,1),n.apply(this,u)}else if(o(n))for(u=Array.prototype.slice.call(arguments,1),a=(d=n.slice()).length,s=0;s<a;s++)d[s].apply(this,u);return!0},n.prototype.addListener=function(e,t){var a;if(!r(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,r(t.listener)?t.listener:t),this._events[e]?o(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,o(this._events[e])&&!this._events[e].warned&&(a=i(this._maxListeners)?n.defaultMaxListeners:this._maxListeners)&&a>0&&this._events[e].length>a&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},n.prototype.on=n.prototype.addListener,n.prototype.once=function(e,t){if(!r(t))throw TypeError("listener must be a function");var n=!1;function o(){this.removeListener(e,o),n||(n=!0,t.apply(this,arguments))}return o.listener=t,this.on(e,o),this},n.prototype.removeListener=function(e,t){var n,i,a,u;if(!r(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(a=(n=this._events[e]).length,i=-1,n===t||r(n.listener)&&n.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(o(n)){for(u=a;u-- >0;)if(n[u]===t||n[u].listener&&n[u].listener===t){i=u;break}if(i<0)return this;1===n.length?(n.length=0,delete this._events[e]):n.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},n.prototype.removeAllListeners=function(e){var t,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(r(n=this._events[e]))this.removeListener(e,n);else if(n)for(;n.length;)this.removeListener(e,n[n.length-1]);return delete this._events[e],this},n.prototype.listeners=function(e){return this._events&&this._events[e]?r(this._events[e])?[this._events[e]]:this._events[e].slice():[]},n.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(r(t))return 1;if(t)return t.length}return 0},n.listenerCount=function(e,t){return e.listenerCount(t)}},function(e,t){e.exports=function(e){var t=document.createElement("style"),n=Object.keys(e).map(function(t){return function(e,t){return e+" {\n"+function(e){return Object.keys(e).map(function(t){return function(e,t){isNaN(t)||0==t||(t+="px");return function(e){return e.replace(/[A-Z]/g,function(e){return"-"+e.toLowerCase()})}(e)+": "+t+";"}(t,e[t])}).join("\n")}(t)+"\n}"}(t,e[t])}).join("\n");return t.setAttribute("type","text/css"),t.appendChild(document.createTextNode(n)),t}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=i(n(17)),o=i(n(7));function i(e){return e&&e.__esModule?e:{default:e}}var a=function(e){function t(){return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t),function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,{getAnnotations:function(e,t){return new Promise(function(n,r){var o=u(e).filter(function(e){return e.page===t&&"Annotation"===e.class});n({documentId:e,pageNumber:t,annotations:o})})},getAnnotation:function(e,t){return Promise.resolve(u(e)[d(e,t)])},addAnnotation:function(e,t,n){return new Promise(function(o,i){n.class="Annotation",n.uuid=(0,r.default)(),n.page=t;var a=u(e);a.push(n),s(e,a),o(n)})},editAnnotation:function(e,t,n){return new Promise(function(r,o){var i=u(e);i[d(e,t)]=n,s(e,i),r(n)})},deleteAnnotation:function(e,t){return new Promise(function(n,r){var o=d(e,t);if(o>-1){var i=u(e);i.splice(o,1),s(e,i)}n(!0)})},getComments:function(e,t){return new Promise(function(n,r){n(u(e).filter(function(e){return"Comment"===e.class&&e.annotation===t}))})},addComment:function(e,t,n){return new Promise(function(o,i){var a={class:"Comment",uuid:(0,r.default)(),annotation:t,content:n},d=u(e);d.push(a),s(e,d),o(a)})},deleteComment:function(e,t){return new Promise(function(n,r){u(e);for(var o=-1,i=u(e),a=0,d=i.length;a<d;a++)if(i[a].uuid===t){o=a;break}o>-1&&(i.splice(o,1),s(e,i)),n(!0)})}}))}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,o.default),t}();function u(e){return JSON.parse(localStorage.getItem(e+"/annotations"))||[]}function s(e,t){localStorage.setItem(e+"/annotations",JSON.stringify(t))}function d(e,t){for(var n=-1,r=u(e),o=0,i=r.length;o<i;o++)if(r[o].uuid===t){n=o;break}return n}t.default=a,e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){return o.replace(r,i)};var r=/[xy]/g,o="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx";function i(e){var t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)}e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n){return new Promise(function(o,i){return e.innerHTML="",e.setAttribute("data-pdf-annotate-container",!0),e.setAttribute("data-pdf-annotate-viewport",JSON.stringify(t)),e.removeAttribute("data-pdf-annotate-document"),e.removeAttribute("data-pdf-annotate-page"),n?(e.setAttribute("data-pdf-annotate-document",n.documentId),e.setAttribute("data-pdf-annotate-page",n.pageNumber),Array.isArray(n.annotations)&&0!==n.annotations.length?(n.annotations.forEach(function(n){(0,r.default)(e,n,t)}),void o(e)):o(e)):o(e)})};o(n(0));var r=o(n(2));o(n(6));function o(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,n){"use strict";
/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var r=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable;e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map(function(e){return t[e]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(e){r[e]=e}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(e){return!1}}()?Object.assign:function(e,t){for(var n,a,u=function(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}(e),s=1;s<arguments.length;s++){for(var d in n=Object(arguments[s]))o.call(n,d)&&(u[d]=n[d]);if(r){a=r(n);for(var l=0;l<a.length;l++)i.call(n,a[l])&&(u[a[l]]=n[a[l]])}}return u}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return(0,r.default)(t,{stroke:(0,o.default)(e.color||"#f00"),strokeWidth:1}),e.rectangles.forEach(function(e){var n=document.createElementNS("http://www.w3.org/2000/svg","line");(0,r.default)(n,{x1:e.x,y1:e.y,x2:e.x+e.width,y2:e.y}),t.appendChild(n)}),t};var r=i(n(3)),o=i(n(5));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){for(var t=[],n=document.createElementNS("http://www.w3.org/2000/svg","path"),i=0,a=e.lines.length;i<a;i++){var u=e.lines[i],s=e.lines[i+1];s&&t.push("M"+u[0]+" "+u[1]+" "+s[0]+" "+s[1])}return(0,r.default)(n,{d:t.join(" ")+"Z",stroke:(0,o.default)(e.color||"#000"),strokeWidth:e.width||1,fill:"none"}),n};var r=i(n(3)),o=i(n(5));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","svg"),n=document.createElementNS("http://www.w3.org/2000/svg","svg"),a=document.createElementNS("http://www.w3.org/2000/svg","rect"),u=document.createElementNS("http://www.w3.org/2000/svg","path");return(0,r.default)(t,{width:o,height:o,x:e.x,y:e.y}),(0,r.default)(n,{width:o,height:o,x:0,y:.05*o*-1,viewBox:"0 0 1000 1000"}),(0,r.default)(a,{width:o,height:o,stroke:"#000",fill:"#ff0"}),(0,r.default)(u,{d:i,strokeWidth:50,stroke:"#000",fill:"#fff"}),n.appendChild(u),t.appendChild(a),t.appendChild(n),t};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(3));var o=25,i="M499.968 214.336q-113.832 0 -212.877 38.781t-157.356 104.625 -58.311 142.29q0 62.496 39.897 119.133t112.437 97.929l48.546 27.9 -15.066 53.568q-13.392 50.778 -39.06 95.976 84.816 -35.154 153.45 -95.418l23.994 -21.204 31.806 3.348q38.502 4.464 72.54 4.464 113.832 0 212.877 -38.781t157.356 -104.625 58.311 -142.29 -58.311 -142.29 -157.356 -104.625 -212.877 -38.781z";e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("highlight"===e.type){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return(0,r.default)(t,{fill:(0,o.default)(e.color||"#ff0"),fillOpacity:.2}),e.rectangles.forEach(function(e){t.appendChild(a(e))}),t}var n=a(e);return(0,r.default)(n,{stroke:(0,o.default)(e.color||"#f00"),fill:"none"}),n};var r=i(n(3)),o=i(n(5));function i(e){return e&&e.__esModule?e:{default:e}}function a(e){var t=document.createElementNS("http://www.w3.org/2000/svg","rect");return(0,r.default)(t,{x:e.x,y:e.y,width:e.width,height:e.height}),t}e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","text");return(0,r.default)(t,{x:e.x,y:e.y+parseInt(e.size,10),fill:(0,o.default)(e.color||"#000"),fontSize:e.size}),t.innerHTML=e.content,t};var r=i(n(3)),o=i(n(5));function i(e){return e&&e.__esModule?e:{default:e}}e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t){var n=document.createElement("div"),r=document.createTextNode(e);return n.appendChild(r),n.setAttribute("id","pdf-annotate-screenreader-"+t),n.style.position="absolute",n.style.left="-10000px",n.style.top="auto",n.style.width="1px",n.style.height="1px",n.style.overflow="hidden",n},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e,t,n,i){if((0,r.default)(e,t,n,i,!0))return!0;var a=document.querySelector('svg[data-pdf-annotate-page="'+i+'"]'),u=a.getBoundingClientRect(),s=[].concat(function(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}(a.parentNode.querySelectorAll(".textLayer > div")));n=(0,o.scaleUp)(a,{y:n}).y+u.top,t=(0,o.scaleUp)(a,{x:t}).x+u.left;for(var d=0,l=s.length;d<l;d++){var c=s[d],f=c.getBoundingClientRect();if(n<=f.top)return c.parentNode.insertBefore(e,c),!0}var p=a.parentNode.querySelector(".textLayer");if(p){var v=p.getBoundingClientRect();if((0,o.pointIntersectsRect)(t,n,v))return p.appendChild(e),!0}return!1};var r=function(e){return e&&e.__esModule?e:{default:e}}(n(9)),o=n(1);e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){(0,a.addEventListener)("annotation:add",function(e,t,n){d(e,t,n.type)}),(0,a.addEventListener)("annotation:edit",function(e,t,n){d(e,n.page,n.type)}),(0,a.addEventListener)("annotation:delete",l),(0,a.addEventListener)("comment:add",c),(0,a.addEventListener)("comment:delete",f)};s(n(8));var r=s(n(6)),o=s(n(11)),i=s(n(10)),a=n(4),u=s(n(0));function s(e){return e&&e.__esModule?e:{default:e}}function d(e,t,n){u.default.getStoreAdapter().getAnnotations(e,t).then(function(e){return e.annotations.filter(function(e){return e.type===n})}).then(function(t){return t.forEach(function(t){l(e,t.uuid)}),t}).then(r.default)}function l(e,t){p("pdf-annotate-screenreader-"+t),p("pdf-annotate-screenreader-"+t+"-end")}function c(e,t,n){var r=document.querySelector("pdf-annotate-screenreader-comment-list-"+t);(r?Promise.resolve(!0):(0,i.default)(e,t,[]).then(function(){return r=document.querySelector("pdf-annotate-screenreader-comment-list-"+t),!0})).then(function(){(0,o.default)(n)})}function f(e,t){p("pdf-annotate-screenreader-comment-"+t)}function p(e){var t=document.getElementById(e);t&&t.parentNode.removeChild(t)}e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=n(4),o=n(29),i=n(30),a=n(31),u=n(32),s=n(33),d=n(34);t.default={addEventListener:r.addEventListener,removeEventListener:r.removeEventListener,fireEvent:r.fireEvent,disableEdit:o.disableEdit,enableEdit:o.enableEdit,disablePen:i.disablePen,enablePen:i.enablePen,setPen:i.setPen,disablePoint:a.disablePoint,enablePoint:a.enablePoint,disableRect:u.disableRect,enableRect:u.enableRect,disableText:s.disableText,enableText:s.enableText,setText:s.setText,createPage:d.createPage,renderPage:d.renderPage},e.exports=t.default},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.enableEdit=function(){if(l)return;l=!0,(0,a.addEventListener)("annotation:click",L)},t.disableEdit=function(){if(m(),!l)return;l=!1,(0,a.removeEventListener)("annotation:click",L)};var o=s(n(0)),i=s(n(2)),a=n(4),u=n(1);function s(e){return e&&e.__esModule?e:{default:e}}function d(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var l=!1,c=!1,f=void 0,p=void 0,v=void 0,h=void 0,y=void 0,g=3;function m(){f&&(f.parentNode.removeChild(f),f=null),document.removeEventListener("click",x),document.removeEventListener("keyup",_),document.removeEventListener("mousedown",w),document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",E),(0,u.enableUserSelect)()}function b(){if(f){var e=f.getAttribute("data-target-id"),t=document.querySelectorAll('[data-pdf-annotate-id="'+e+'"]'),n=f.parentNode.querySelector("svg.annotationLayer"),r=(0,u.getMetadata)(n).documentId;[].concat(d(t)).forEach(function(e){e.parentNode.removeChild(e)}),o.default.getStoreAdapter().deleteAnnotation(r,e),m()}}function x(e){if((0,u.findSVGAtPoint)(e.clientX,e.clientY)){var t=document.getElementById("pdf-annotate-edit-overlay");if(t){if(c||e.target===t)return;m()}}}function _(e){f&&46===e.keyCode&&"textarea"!==e.target.nodeName.toLowerCase()&&"input"!==e.target.nodeName.toLowerCase()&&b()}function w(e){if(e.target===f){var t=f.getAttribute("data-target-id"),n=document.querySelector('[data-pdf-annotate-id="'+t+'"]').getAttribute("data-pdf-annotate-type");"highlight"!==n&&"strikeout"!==n&&(c=!0,p=e.clientX,v=e.clientY,h=f.offsetLeft,y=f.offsetTop,f.style.background="rgba(255, 255, 255, 0.7)",f.style.cursor="move",f.querySelector("a").style.display="none",document.addEventListener("mousemove",A),document.addEventListener("mouseup",E),(0,u.disableUserSelect)())}}function A(e){f.getAttribute("data-target-id");var t=f.parentNode.getBoundingClientRect(),n=y+(e.clientY-v),r=h+(e.clientX-p),o=t.height,i=t.width;n>0&&n+f.offsetHeight<o&&(f.style.top=n+"px"),r>0&&r+f.offsetWidth<i&&(f.style.left=r+"px")}function E(e){var t=f.getAttribute("data-target-id"),n=document.querySelectorAll('[data-pdf-annotate-id="'+t+'"]'),a=n[0].getAttribute("data-pdf-annotate-type"),s=f.parentNode.querySelector("svg.annotationLayer"),l=(0,u.getMetadata)(s).documentId;function p(e,t){return{deltaX:g+(0,u.scaleDown)(s,{x:f.offsetLeft}).x-e,deltaY:g+(0,u.scaleDown)(s,{y:f.offsetTop}).y-t}}f.querySelector("a").style.display="",o.default.getStoreAdapter().getAnnotation(l,t).then(function(e){if(["area","highlight","point","textbox"].indexOf(a)>-1){var c=function(e,t){return p(parseInt(n[0].getAttribute(e),10),parseInt(n[0].getAttribute(t),10))}("x","y"),f=c.deltaX,v=c.deltaY;[].concat(d(n)).forEach(function(t,n){if(0!==v){var r=parseInt(t.getAttribute("y"),10)+v,o=r;"textbox"===a&&(o+=e.size),"point"===a&&(o=(0,u.scaleUp)(s,{viewY:o}).viewY),t.setAttribute("y",o),e.rectangles?e.rectangles[n].y=r:e.y&&(e.y=r)}if(0!==f){var i=parseInt(t.getAttribute("x"),10)+f,d=i;"point"===a&&(d=(0,u.scaleUp)(s,{viewX:d}).viewX),t.setAttribute("x",d),e.rectangles?e.rectangles[n].x=i:e.x&&(e.x=i)}})}else if("drawing"===a){var h=(0,u.scaleDown)(s,(0,u.getAnnotationRect)(n[0])),y=r(e.lines[0],2),g=y[0],m=y[1],b=p(g,m),x=b.deltaX,_=b.deltaY;_+=m-h.top,x+=g-h.left,e.lines.forEach(function(t,n){var o=r(e.lines[n],2),i=o[0],a=o[1];e.lines[n][0]=i+x,e.lines[n][1]=a+_}),n[0].parentNode.removeChild(n[0]),(0,i.default)(s,e)}o.default.getStoreAdapter().editAnnotation(l,t,e)}),setTimeout(function(){c=!1},0),f.style.background="",f.style.cursor="",document.removeEventListener("mousemove",A),document.removeEventListener("mouseup",E),(0,u.enableUserSelect)()}function L(e){!function(e){m(),f=document.createElement("div");var t=document.createElement("a"),n=(0,u.findSVGContainer)(e).parentNode,r=e.getAttribute("data-pdf-annotate-id"),o=(0,u.getAnnotationRect)(e),i=o.left-g,a=o.top-g;f.setAttribute("id","pdf-annotate-edit-overlay"),f.setAttribute("data-target-id",r),f.style.boxSizing="content-box",f.style.position="absolute",f.style.top=a+"px",f.style.left=i+"px",f.style.width=o.width+"px",f.style.height=o.height+"px",f.style.border=g+"px solid "+u.BORDER_COLOR,f.style.borderRadius=g+"px",t.innerHTML="Ã—",t.setAttribute("href","javascript://"),t.style.background="#fff",t.style.borderRadius="20px",t.style.border="1px solid #bbb",t.style.color="#bbb",t.style.fontSize="16px",t.style.padding="2px",t.style.textAlign="center",t.style.textDecoration="none",t.style.position="absolute",t.style.top="-13px",t.style.right="-13px",t.style.width="25px",t.style.height="25px",f.appendChild(t),n.appendChild(f),document.addEventListener("click",x),document.addEventListener("keyup",_),document.addEventListener("mousedown",w),t.addEventListener("click",b),t.addEventListener("mouseover",function(){t.style.color="#35A4DC",t.style.borderColor="#999",t.style.boxShadow="0 1px 1px #ccc"}),t.addEventListener("mouseout",function(){t.style.color="#bbb",t.style.borderColor="#bbb",t.style.boxShadow=""}),f.addEventListener("mouseover",function(){c||(t.style.display="")}),f.addEventListener("mouseout",function(){t.style.display="none"})}(e)}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setPen=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"000000";s=parseInt(e,10),d=t},t.enablePen=function(){if(u)return;u=!0,document.addEventListener("mousedown",f),document.addEventListener("keyup",h),(0,i.disableUserSelect)()},t.disablePen=function(){if(!u)return;u=!1,document.removeEventListener("mousedown",f),document.removeEventListener("keyup",h),(0,i.enableUserSelect)()};var r=a(n(0)),o=a(n(2)),i=n(1);function a(e){return e&&e.__esModule?e:{default:e}}var u=!1,s=void 0,d=void 0,l=void 0,c=void 0;function f(){l=null,c=[],document.addEventListener("mousemove",v),document.addEventListener("mouseup",p)}function p(e){var t=void 0;if(c.length>1&&(t=(0,i.findSVGAtPoint)(e.clientX,e.clientY))){var n=(0,i.getMetadata)(t),a=n.documentId,u=n.pageNumber;r.default.getStoreAdapter().addAnnotation(a,u,{type:"drawing",width:s,color:d,lines:c}).then(function(e){l&&t.removeChild(l),(0,o.default)(t,e)})}document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",p)}function v(e){!function(e,t){var n=(0,i.findSVGAtPoint)(e,t);if(!n)return;var r=n.getBoundingClientRect(),a=(0,i.scaleDown)(n,{x:e-r.left,y:t-r.top});if(c.push([a.x,a.y]),c.length<=1)return;l&&n.removeChild(l);l=(0,o.default)(n,{type:"drawing",color:d,width:s,lines:c})}(e.clientX,e.clientY)}function h(e){27===e.keyCode&&(c=null,l.parentNode.removeChild(l),document.removeEventListener("mousemove",v),document.removeEventListener("mouseup",p))}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enablePoint=function(){if(u)return;u=!0,document.addEventListener("mouseup",d)},t.disablePoint=function(){if(!u)return;u=!1,document.removeEventListener("mouseup",d)};var r=a(n(0)),o=a(n(2)),i=n(1);function a(e){return e&&e.__esModule?e:{default:e}}var u=!1,s=void 0;function d(e){!s&&(0,i.findSVGAtPoint)(e.clientX,e.clientY)&&((s=document.createElement("input")).setAttribute("id","pdf-annotate-point-input"),s.setAttribute("placeholder","Enter comment"),s.style.border="3px solid "+i.BORDER_COLOR,s.style.borderRadius="3px",s.style.position="absolute",s.style.top=e.clientY+"px",s.style.left=e.clientX+"px",s.addEventListener("blur",l),s.addEventListener("keyup",c),document.body.appendChild(s),s.focus())}function l(){f()}function c(e){27===e.keyCode?p():13===e.keyCode&&f()}function f(){if(s.value.trim().length>0){var e=parseInt(s.style.left,10),t=parseInt(s.style.top,10),n=s.value.trim(),a=(0,i.findSVGAtPoint)(e,t);if(!a)return;var u=a.getBoundingClientRect(),d=(0,i.getMetadata)(a),l=d.documentId,c=d.pageNumber,f=Object.assign({type:"point"},(0,i.scaleDown)(a,{x:e-u.left,y:t-u.top}));r.default.getStoreAdapter().addAnnotation(l,c,f).then(function(e){r.default.getStoreAdapter().addComment(l,e.uuid,n),(0,o.default)(a,e)})}p()}function p(){try{s.removeEventListener("blur",l),s.removeEventListener("keyup",c),document.body.removeChild(s),s=null}catch(e){}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.enableRect=function(e){if(d=e,s)return;s=!0,document.addEventListener("mouseup",h),document.addEventListener("mousedown",p),document.addEventListener("keyup",y)},t.disableRect=function(){if(!s)return;s=!1,document.removeEventListener("mouseup",h),document.removeEventListener("mousedown",p),document.removeEventListener("keyup",y)};var r=a(n(0)),o=a(n(2)),i=n(1);function a(e){return e&&e.__esModule?e:{default:e}}function u(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var s=!1,d=void 0,l=void 0,c=void 0,f=void 0;function p(e){var t=void 0;if("area"===d&&(t=(0,i.findSVGAtPoint)(e.clientX,e.clientY))){var n=t.getBoundingClientRect();c=e.clientY,f=e.clientX,(l=document.createElement("div")).style.position="absolute",l.style.top=c-n.top+"px",l.style.left=f-n.left+"px",l.style.border="3px solid "+i.BORDER_COLOR,l.style.borderRadius="3px",t.parentNode.appendChild(l),document.addEventListener("mousemove",v),(0,i.disableUserSelect)()}}function v(e){var t=l.parentNode.querySelector("svg.annotationLayer").getBoundingClientRect();f+(e.clientX-f)<t.right&&(l.style.width=e.clientX-f+"px"),c+(e.clientY-c)<t.bottom&&(l.style.height=e.clientY-c+"px")}function h(e){var t=void 0;if("area"!==d&&(t=function(){try{var e=window.getSelection().getRangeAt(0).getClientRects();if(e.length>0&&e[0].width>0&&e[0].height>0)return e}catch(e){}return null}())){(0,i.findSVGAtPoint)(t[0].left,t[0].top);g(d,[].concat(u(t)).map(function(e){return{top:e.top,left:e.left,width:e.width,height:e.height}}))}else if("area"===d&&l){var n=l.parentNode.querySelector("svg.annotationLayer").getBoundingClientRect();g(d,[{top:parseInt(l.style.top,10)+n.top,left:parseInt(l.style.left,10)+n.left,width:parseInt(l.style.width,10),height:parseInt(l.style.height,10)}]),l.parentNode.removeChild(l),l=null,document.removeEventListener("mousemove",v),(0,i.enableUserSelect)()}}function y(e){27===e.keyCode&&(window.getSelection().removeAllRanges(),l&&l.parentNode&&(l.parentNode.removeChild(l),l=null,document.removeEventListener("mousemove",v)))}function g(e,t,n){var a=(0,i.findSVGAtPoint)(t[0].left,t[0].top),s=void 0;if(a){var d=a.getBoundingClientRect();if(n||("highlight"===e?n="FFFF00":"strikeout"===e&&(n="FF0000")),0!==(s={type:e,color:n,rectangles:[].concat(u(t)).map(function(t){var n=0;return"strikeout"===e&&(n=t.height/2),(0,i.scaleDown)(a,{y:t.top+n-d.top,x:t.left-d.left,width:t.width,height:t.height})}).filter(function(e){return e.width>0&&e.height>0&&e.x>-1&&e.y>-1})}).rectangles.length){if("area"===e){var l=s.rectangles[0];delete s.rectangles,s.x=l.x,s.y=l.y,s.width=l.width,s.height=l.height}var c=(0,i.getMetadata)(a),f=c.documentId,p=c.pageNumber;r.default.getStoreAdapter().addAnnotation(f,p,s).then(function(e){(0,o.default)(a,e)})}}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.setText=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:12,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"000000";d=parseInt(e,10),l=t},t.enableText=function(){if(u)return;u=!0,document.addEventListener("mouseup",c)},t.disableText=function(){if(!u)return;u=!1,document.removeEventListener("mouseup",c)};var r=a(n(0)),o=a(n(2)),i=n(1);function a(e){return e&&e.__esModule?e:{default:e}}var u=!1,s=void 0,d=void 0,l=void 0;function c(e){!s&&(0,i.findSVGAtPoint)(e.clientX,e.clientY)&&((s=document.createElement("input")).setAttribute("id","pdf-annotate-text-input"),s.setAttribute("placeholder","Enter text"),s.style.border="3px solid "+i.BORDER_COLOR,s.style.borderRadius="3px",s.style.position="absolute",s.style.top=e.clientY+"px",s.style.left=e.clientX+"px",s.style.fontSize=d+"px",s.addEventListener("blur",f),s.addEventListener("keyup",p),document.body.appendChild(s),s.focus())}function f(){v()}function p(e){27===e.keyCode?h():13===e.keyCode&&v()}function v(){if(s.value.trim().length>0){var e=parseInt(s.style.left,10),t=parseInt(s.style.top,10),n=(0,i.findSVGAtPoint)(e,t);if(!n)return;var a=(0,i.getMetadata)(n),u=a.documentId,c=a.pageNumber,f=n.getBoundingClientRect(),p=Object.assign({type:"textbox",size:d,color:l,content:s.value.trim()},(0,i.scaleDown)(n,{x:e-f.left,y:t-f.top,width:s.offsetWidth,height:s.offsetHeight}));r.default.getStoreAdapter().addAnnotation(u,c,p).then(function(e){(0,o.default)(n,e)})}h()}function h(){try{s&&(s.removeEventListener("blur",f),s.removeEventListener("keyup",p),document.body.removeChild(s),s=null)}catch(e){console.log("Try/catch is necessary because exist a error in Safari")}}},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],r=!0,o=!1,i=void 0;try{for(var a,u=e[Symbol.iterator]();!(r=(a=u.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){o=!0,i=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw i}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}();t.createPage=function(e){var t=document.createElement("div");t.innerHTML=u;var n=t.children[0],r=n.querySelector("canvas");return n.setAttribute("id","pageContainer"+e),n.setAttribute("data-page-number",e),r.mozOpaque=!0,r.setAttribute("id","page"+e),n},t.renderPage=function(e,t){var n=t.documentId,a=t.pdfDocument,u=t.scale,l=t.rotate;return Promise.all([a.getPage(e),o.default.getAnnotations(n,e)]).then(function(t){var n=r(t,2),a=n[0],c=n[1],f=document.getElementById("pageContainer"+e),p=f.querySelector(".annotationLayer"),v=f.querySelector(".canvasWrapper canvas"),h=v.getContext("2d",{alpha:!1}),y=a.getViewport(u,l),g=function(e,t,n){var r=document.getElementById("pageContainer"+e),o=r.querySelector(".canvasWrapper canvas"),i=r.querySelector(".annotationLayer"),a=r.querySelector(".canvasWrapper"),u=r.querySelector(".textLayer"),l=function(e){var t=window.devicePixelRatio||1,n=e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1,r=t/n;return{sx:r,sy:r,scaled:1!==r}}(n),c=l.scaled?[l.sx,0,0,l.sy,0,0]:null,f=s(l.sx),p=s(l.sy);return r.style.visibility="",o.width=d(t.width*l.sx,f[0]),o.height=d(t.height*l.sy,p[0]),o.style.width=d(t.width,f[1])+"px",o.style.height=d(t.height,f[1])+"px",i.setAttribute("width",t.width),i.setAttribute("height",t.height),i.style.width=t.width+"px",i.style.height=t.height+"px",r.style.width=t.width+"px",r.style.height=t.height+"px",a.style.width=t.width+"px",a.style.height=t.height+"px",u.style.width=t.width+"px",u.style.height=t.height+"px",c}(e,y,h);return Promise.all([a.render({canvasContext:h,viewport:y,transform:g}),o.default.render(p,y,c)]).then(function(){return a.getTextContent({normalizeWhitespace:!0}).then(function(t){return new Promise(function(n,r){var o=f.querySelector(".textLayer"),a=new PDFJS.DefaultTextLayerFactory,u=a.createTextLayerBuilder(o,e-1,y);u.setTextContent(t),u.render(),setTimeout(function(){try{(0,i.default)(c.annotations),n()}catch(e){r(e)}})})})}).then(function(){return f.setAttribute("data-loaded","true"),[a,c]})})};var o=a(n(0)),i=a(n(6));function a(e){return e&&e.__esModule?e:{default:e}}var u='\n  <div style="visibility: hidden;" class="page" data-loaded="false">\n    <div class="canvasWrapper">\n      <canvas></canvas>\n    </div>\n    <svg class="annotationLayer"></svg>\n    <div class="textLayer"></div>\n  </div>\n';function s(e){if(Math.floor(e)===e)return[e,1];var t=1/e;if(t>8)return[1,8];if(Math.floor(t)===t)return[1,t];for(var n=e>1?t:e,r=0,o=1,i=1,a=1;;){var u=r+i,s=o+a;if(s>8)break;n<=u/s?(i=u,a=s):(r=u,o=s)}return n-r/o<i/a-n?n===e?[r,o]:[o,r]:n===e?[i,a]:[a,i]}function d(e,t){var n=e%t;return 0===n?e:Math.round(e-n+t)}}])});
//# sourceMappingURL=pdf-annotate.js.map